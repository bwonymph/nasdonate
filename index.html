<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>NAS Donate</title>
		<meta name="description" content="Donations on Nebulas" />
		<meta name="keywords" content="charity, donations, nebulas, blockchain" />
		<meta name="author" content="Codrops" />
		<link rel="shortcut icon" href="favicon.ico">
		<link rel="stylesheet" type="text/css" href="css/base.css" />
		<link rel="stylesheet" type="text/css" href="css/demo1.css" />
		<script>document.documentElement.className="js";var supportsCssVars=function(){var e,t=document.createElement("style");return t.innerHTML="root: { --tmp-var: bold; }",document.head.appendChild(t),e=!!(window.CSS&&window.CSS.supports&&window.CSS.supports("font-weight","var(--tmp-var)")),t.parentNode.removeChild(t),e};supportsCssVars()||alert("Please view this demo in a modern browser that supports CSS Variables.");</script>
		<script src=nebPay.js></script> <!-- Nebpay API-->
		<script type="text/javascript" src="js/nebPay.min.js"></script>
	</head>
	<body class="demo-1">
		<main>
			<div class="message">To see the menu, please view on a larger screen.</div>
			<div class="content content--fixed">
				<button class="menu-trigger">+ Donation Opportunites and more</button>
			</div>
			<div id="content-1" class="content content--switch content--switch-current">
				<img src="img/nebulas.png" style="max-width:250px"></img>
				<h2 class="content__title">NAS Donate</h2>
				<div class="content__date">Donation Platform built on Nebulas</div>
			</div>
			<div id="content-2" class="content content--switch">
				<h2 class="content__title">Contact Us</h2>
				<p class="content__text">Want your charity featured? Send us an enquiry<a href="mailto:nasdonate@gmail.com"> here</a>. We check and confirm charities on a rolling basis, so please include your information and NAS address in your email. We do each confirmation by hand to make sure to include legitimate donation opportunities.</p>
			</div>
			<div id="content-6" class="content content--switch">
				<h2 class="content__title">Donation Opportunities</h2>
				<p class="content__text">Below are our current donation opportunies: </p>
				<h2 class="content__text">UTK</h2>
				<p>Locations: Berkeley, CA. Peru. Columbia.</p>
				<p class="content__text">United Technologies for Kids is a non-profit organization dedicated to encouraging STEM education in high schools globally. </p>
		      	<p class ="content__text">UTK hopes to inspire younger generations all across the world by teaching the simplicities of working with modern-age technology and demonstrating how any individual's ideas could be brought to reality. At the end of the program, students will have developed the self confidence and motivation to manifest their ideas into products and tools that could have an impact in the world.</p>
		      	<div style="display: inline-block">
		        <div>Donation Amount:</div>

		        <input type="text" id="inputAmount" placeholder="1 NAS"/>
		        <input type="text" id="donatename" placeholder="Your Name"/>
		        <input style="visibility:hidden"type="text" id="inputReceiveAddress" value="n1FXpzyEbfjjC8Rm7FqRfJ4CxKvS27SXKik"/>
			      </div>
			      <button type="button" onClick="onPayClick();">Donate</button>
			      <p id="txResult" style="color:#FF0000;font-size:12px;"></p>
			      <p class="content__text">Opportunities are updated on a rolling basis</p>
			  	</div>
			  	
			</div>
			<div id="content-4" class="content content--switch">
				<h2 class="content__title">UTK</h2>
				<p>Locations: Berkeley, CA. Peru. Columbia.</p>
				<p class="content__text">United Technologies for Kids is a non-profit organization dedicated to encouraging STEM education in high schools globally. </p>
		      	<p>UTK hopes to inspire younger generations all across the world by teaching the simplicities of working with modern-age technology and demonstrating how any individual's ideas could be brought to reality. At the end of the program, students will have developed the self confidence and motivation to manifest their ideas into products and tools that could have an impact in the world.</p>
		      	<div style="display: inline-block">
		        <div>Donation Amount:</div>

		        <input type="text" id="inputAmount" placeholder="1 NAS"/>
		        <input type="text" id="donatename" placeholder="Your Name"/>
		        <input type="text" id="inputReceiveAddress" value="n1FXpzyEbfjjC8Rm7FqRfJ4CxKvS27SXKik"/>
		      </div>
		      <button type="button" onClick="onPayClick();">Donate</button>
		      <p id="txResult" style="color:#FF0000;font-size:12px;"></p>
		  	</div>
			</div>
			<div id="content-5" class="content content--switch">
				<h2 class="content__title">Nebulas</h2>
				<p class="content__text">Nebulas is a next generation public blockchain, aiming for a continuously improving ecosystem.
				Based on its blockchain valuation mechanism, Nebulas proposes future-oriented incentive and consensus systems, and the ability to self-evolve without forking.</p>
				<a href="https://nebulas.io/">Find out more!</a>
			</div>
			<div id="content-3" class="content content--switch">
				<h2 class="content__title">NAS Donate</h2>
				<p class="content__text">Nas Donate is a donation platform allowing users to donate NAS tokens to different charitiable opportunities.</p>
				<p>All these donations are recorded on the Nebulas Blockchain, and facilitates easier and transparent donations.</P>
				<p>All charity and non-profit initiatives are verified before being included on the platform to insure that users' donations are being directed to the appropriate entities. We plan in the future to included smart contract tracking to monitor the usage of donated funds by the receiving entities to make sure funds are being used correctly, as well as include a consensus verification system to facilitate the addition of charities/non-profit entities to NAS Donate.</p>

				<p>NAS Donate requires the <a href="https://github.com/ChengOrangeJu/WebExtensionWallet">Nebulas Wallet Extension</a></p>

				<p>For enquiries or submitting your charity <a href="mailto:nasdonate@gmail.com">email</a> Make sure to include NAS address and contact info for verification.</p>
				<p>Powered by <a href="https://nebulas.io/">Nebulas</a>.</p>
			</div>
			<nav class="grim">
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--1"></div>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--2"></div>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--3"></div>
					<div class="grim__item-content">
						<div class="grim__item-inner">
							<button class="menu-trigger menu-trigger--close">- close</button>
						</div>
					</div>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--4"></div>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--5"></div>
					<a href="#content-1" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">home</h3>
						</div>
					</a>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--6"></div>
					<a href="#content-2" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">Contact</h3>
							<span class="grim__item-desc">Want a charity to be featured? </span>
						</div>
					</a>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--7"></div>
					<a href="#content-3" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">Info</h3>
							<span class="grim__item-desc">Find out more about us</span>
						</div>
					</a>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--8"></div>
					<a href="#content-5" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">Nebulas</h3>
							<span class="grim__item-desc">Find out more about Nebulas</span>
						</div>
					</a>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--9"></div>
					<a href="#content-4" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">Featured Charity</h3>
							<span class="grim__item-desc">UTK - Lima, Peru</span>
						</div>
					</a>
				</div>
				<div class="grim__item">
					<div class="grim__item-bg grim__item-bg--10" data-duration="1000" data-easing="easeOutQuint"></div>
					<a href="#content-6" class="grim__link grim__item-content">
						<div class="grim__item-inner">
							<h3 class="grim__item-title">Donation Now</h3>
							<span class="grim__item-desc">View available Opportunities</span>
						</div>
					</a>
				</div>
			</nav>
		</main>
		<script src="js/demo.js"></script>
		<script src="js/anime.min.js"></script>
		<script src="js/menu.js"></script>
		<script>
		    var NebPay = require("nebpay");
		    var nebPay = new NebPay();
		    var serialNumber;

		    //to check if the extension is installed
		    //if the extension is installed, var "webExtensionWallet" will be injected in to web page
		    if(typeof(webExtensionWallet) === "undefined"){
		        alert ("Extension wallet is not installed, please install it first.")
		    }

		    var dappAddress= "n1is9uewKE964mWiivG5GtVYWdP8oQagBLk";
		    var initKey = ' ';
		    var oldSize = 0;
		    var page= 0 ;
		    var total = 0;
		    var amount = 0;

		    function onClickSendTx() { //Send Money to Donation Address
		        var to = document.getElementById("inputReceiveAddress").value;
		        amount = document.getElementById("inputAmount").value;
		        nebPay.pay(to, amount, {
		            qrcode: {
		                showQRCode: false
		            },
		            goods: {
		                name: "Donate",
		                desc: "Donate goods"
		            },
		            //callback: cbSendTx
		            listener: cbSendTx

		        });
		        submit(); //activate submit function to post donation info on Nebulas Blockchain
		    }
		    function onPayClick() {
	            var to = document.getElementById("inputReceiveAddress").value;
	            var value = document.getElementById("inputAmount").value;
	            serialNumber = nebPay.pay(to, value, {
	                qrcode: {
	                    showQRCode: false
	                },
	                goods: {
	                    name: "Donate",
	                    desc: "Donate goods"
	                },
	                listener: cbSendTx,  //set listener for extension transaction result
	            });
	            setTimeout(() => {
	                onrefreshClick();   //search transaction result from server (result upload to server by app)
	            }, 1000);
	            // submit();
        	}

		    function cbSendTx(resp){
		        console.log("callback resp: " + JSON.stringify(resp))
		        document.getElementById("txResult").innerHTML = "send transaction result:\n" +  JSON.stringify(resp)
		    }

		    function submit() {
					// if($("#donatename").val() == '') {
					// 	alert('Must fill donation name, reject transaction and start over');
					// 	return;}
					var to = dappAddress;
					var value = 0;
					var callFunction = "set"
					var callArgs = [];
					callArgs.submit($inputAmount);
					// callArgs.submit($("#donatename").val() + ":" + new Date().getTime());
					nebPay.call(to, value, callFunction, JSON.stringify(callArgs), { // use nebpay's call interface to call the contract,
						listener: cbPush
					});
				}
			function cbPush(resp) {
					console.log("response of push: " + resp);
					$("#donatename").val('')
				}
			function updatedonate() {
			    var value = 0;
			    var callFunction = "getWR";
			    var args = "[]";
			    nebPay.simulateCall(dappAddress, value, callFunction, args, {
			        callback: "https://pay.nebulas.io/api/mainnet/pay",
			        listener: function (resp) {
			            try{
			                console.info('callback resp: '+JSON.stringify(response));
			                var address = JSON.parse(response.result);
			                if(record !== "null"){
			                    total = parseInt(record.score);
			                    $('#update').text("Total Amount donated: "+total);
			                }
			            }catch (e){
			                console.log(e)
			            }
			        }
			    	});
				}
			$('#update').click(function () {
			    alert("Total Amount donated: " +total);
			});
		</script>
	</body>
</html>
